# 🧠 基于 GPT-5 的智能体驱动型检索增强生成（Agentic RAG）

一款采用 Agno 框架构建的智能体驱动型检索增强生成（Agentic RAG）应用，集成 GPT-5 模型与 LanceDB 向量数据库，可实现高效的知识检索与问答功能。

## ✨ 功能特点

* **🤖 GPT-5**：采用 OpenAI 最新模型，可生成智能响应

* **🗄️ LanceDB**：轻量级向量数据库，支持快速相似性搜索

* **🔍 智能体驱动型检索增强生成（Agentic RAG）**：具备智能检索能力的增强生成技术

* **📝 Markdown 格式支持**：可生成美观、结构化的响应内容

* **🌐 动态知识扩展**：支持添加 URL 以拓展知识库范围

* **⚡ 实时流输出**：可实时查看回答生成过程

* **🎯 简洁界面**：简化版用户界面（UI），无需复杂配置

## 🚀 快速开始

### 前置条件

* Python 3.11 及以上版本

* 拥有 GPT-5 访问权限的 OpenAI API 密钥

### 安装步骤

1. **克隆项目并进入项目目录**

```
cd rag\_tutorials/agentic\_rag\_gpt5
```

2. **安装依赖包**

```
pip install -r requirements.txt
```

3. **配置 OpenAI API 密钥**

```
export OPENAI\_API\_KEY="your-api-key-here"  # 将"your-api-key-here"替换为实际密钥
```

或创建 `.env` 文件并配置（推荐）：

```
OPENAI\_API\_KEY=your-api-key-here  # 将"your-api-key-here"替换为实际密钥
```

4. **运行应用程序**

```
streamlit run agentic\_rag\_gpt5.py
```

## 🎯 使用方法

1. 在侧边栏中**输入你的 OpenAI API 密钥**

2. 在侧边栏中**输入 URL 以添加知识来源**

3. 通过文本输入框或推荐提示词**提出问题**

4. 实时查看以 Markdown 格式呈现的**流式回答**

### 推荐问题

* **“什么是 Agno？”** —— 了解 Agno 框架及其智能体（Agent）相关功能

* **“Agno 中的团队（Teams）是什么？”** —— 理解 Agno 中 “团队” 的工作机制

* **“如何构建检索增强生成（RAG）系统？”** —— 获取构建 RAG 系统的分步指南

## 🏗️ 架构设计

### 核心组件

* `Agent`**（智能体）**：协调整个问答流程的核心模块

* `UrlKnowledge`**（URL 知识管理）**：处理并加载来自 URL 的文档内容

* `LanceDb`**（Lance 数据库）**：支持高效相似性搜索的向量数据库

* `OpenAIEmbedder`**（OpenAI 嵌入生成器）**：将文本转换为向量嵌入的工具

* `OpenAIChat`**（OpenAI 聊天模块）**：采用 GPT-5-nano 模型生成回答内容

### 数据流程

1. **知识加载**：处理输入的 URL 并将内容存储到 LanceDB 中

2. **向量搜索**：通过 OpenAI 生成的向量嵌入实现语义搜索

3. **回答生成**：由 GPT-5-nano 模型处理检索到的信息并生成回答

4. **流式输出**：实时展示格式化后的回答内容

## 🔧 配置说明

### 数据库设置

* **向量数据库**：采用本地存储模式的 LanceDB

* **表名**：`agentic_rag_docs`（用于存储 RAG 相关文档的表）

* **搜索类型**：向量相似性搜索

## 📚 知识管理

### 添加知识来源

* 通过侧边栏输入新的 URL 即可添加知识来源

* 系统会自动处理并索引新增的知识来源

* 当前已加载的知识来源将以编号列表形式展示

### 默认知识库

* 初始默认包含 Agno 文档：`https://docs.agno.com/introduction/agents.md`

* 支持添加任意基于网页的文档以扩展知识库

## 🎨 界面功能

### 侧边栏

* **API 密钥管理**：安全输入 OpenAI 认证密钥的入口

* **URL 添加**：动态扩展知识库的功能入口

* **当前知识来源**：已加载 URL 的编号列表展示

### 主界面

* **推荐提示词**：快速调用常见问题的预设提示

* **查询输入框**：用于输入自定义问题的大尺寸文本区域

* **实时流输出**：实时展示回答生成过程

* **Markdown 渲染**：以美观格式呈现回答内容

## 🛠️ 技术细节

### 依赖包列表

```
streamlit>=1.28.0  # 用于构建 Web 界面的框架

agno>=0.1.0        # 智能体开发框架

openai>=1.0.0      # OpenAI API 客户端

lancedb>=0.4.0     # LanceDB 向量数据库客户端

python-dotenv>=1.0.0  # 环境变量管理工具
```

### 核心技术特性

* **事件过滤**：仅展示 `RunResponseContent` 类型事件，确保输出内容简洁

* **安全属性访问**：防止因属性缺失导致的程序错误

* **缓存机制**：利用 Streamlit 缓存功能实现高效资源加载

* **错误处理**：对 API 调用及数据处理过程中的错误进行优雅处理

## 🔍 问题排查

### 常见问题

**问题：出现 ModelProviderError（与 max\_tokens 相关）**

* ✅ 解决方案：将参数 `max_tokens` 替换为 `max_completion_tokens`（已修复）

**问题：输出内容中包含工具调用信息**

* ✅ 解决方案：过滤输出内容，仅展示 `RunResponseContent` 类型事件（已修复）

**问题：知识库无法加载**

* 检查 OpenAI API 密钥是否有效

* 确认输入的 URL 可正常访问

* 验证网络连接是否正常

### 性能优化建议

* **资源缓存**：对知识库与智能体进行缓存，提升运行效率

* **流式输出**：实时更新回答内容，避免界面阻塞

* **LanceDB 优势**：本地向量搜索速度快，无需依赖外部服务

## 🎯 应用场景

* **文档问答**：针对技术文档提出问题并获取精准答案

* **研究助手**：整合多个知识来源，辅助研究工作

* **学习工具**：以交互式方式探索复杂主题

* **内容发现**：跨多个来源查找相关信息

**本应用由 Agno、GPT-5 与 LanceDB 开发，注入满满心意 ❤️**
